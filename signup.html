<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <title>Hesap Oluştur</title>
    <script src="https://www.gstatic.com/firebasejs/8.3.3/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.3.3/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.3.3/firebase-firestore.js"></script>
    <style>
        /* Yeni stil */
        body {
            font-family: 'Tajawal', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            direction: rtl;
            user-select: none;
        }

        .form {
            display: flex;
            flex-direction: column;
            gap: 15px;
            background-color: #ffffff;
            padding: 25px;
            width: 90%;
            max-width: 400px;
            
        }

        .flex-column > label {
            color: #000;
            font-weight: 600;
            font-size: 14px;
        }

        .inputForm {
  border: 1.5px solid #e1e1e1;
  border-radius: 10px;
  height: 50px;
  display: flex;
  align-items: center;
  padding-left: 10px;
  transition: 0.2s ease-in-out;
}

.inputForm:focus-within {
  border: 1.5px solid #4361ee;
}

        .input {
            margin-left: 10px;
            border: none;
            width: 85%;
            height: 100%;
            font-size: 16px;
            color: #000;
            outline: none;
        }

        .button-submit {
  font-family: 'Tajawal', sans-serif;
  margin: 20px 0 10px 0;
  background: linear-gradient(to right, #4361ee, #3f37c9);
  border: none;
  color: white;
  font-size: 15px;
  font-weight: 500;
  border-radius: 10px;
  height: 50px;
  width: 100%;
  transition: 0.2s ease-in-out;
}

        .p {
            text-align: center;
            color: black;
            font-size: 14px;
            margin: 5px 0;
        }

        .span {
            color: #4361ee;
            font-weight: 500;
        }

        .span:hover {
            text-decoration: underline;
        }

        /* Pop-up penceresi */
        .popup {
            display: none;
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .popup-content {
            background-color: #ffffff;
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            width: 90%;
            max-width: 300px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            color: #000;
        }

        .popup button {
  font-family: 'Tajawal', sans-serif;
  padding: 10px 20px;
  border: none;
  border-radius: 15px;
  background: linear-gradient(to right, #4361ee, #3f37c9);
  color: white;
  font-size: 14px;
  margin-top: 15px;
}
    </style>
</head>
<body>
    <!-- Yeni yapı -->
    <form class="form">
        <div class="flex-column">
            <label>Ad</label>
  </div>
  <div class="inputForm">
    <svg
      height="60"
      viewBox="0 -9 32 32"
      width="40"
      xmlns="http://www.w3.org/2000/svg"
    >
      <g id="Layer_3" data-name="Layer 3">
        <path
          d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-5 6s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zM11 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5m.5 2.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm0 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1z"
        ></path>
            </svg>
            <input type="text" id="name" class="input" placeholder="Adınızı Girin" required>
        </div>
        <div class="flex-column">
  <label>Telefon Numarası</label>
</div>
<div class="inputForm">
  <svg height="20" viewBox="0 0 24 24" width="20" xmlns="http://www.w3.org/2000/svg">
    <path d="M17 2H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2zm-5 17a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm5-4H7V4h10v11z"></path>
  </svg>
  <input type="tel" id="phone" class="input" placeholder="Telefon Numarası" required>
</div>
        <div class="flex-column">
            <label>E-posta Adresi</label>
        </div>
        <div class="inputForm">
            <svg height="20" viewBox="0 0 32 32" width="20" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="m30.853 13.87a15 15 0 0 0 -29.729 4.082 15.1 15.1 0 0 0 12.876 12.918 15.6 15.6 0 0 0 2.016.13 14.85 14.85 0 0 0 7.715-2.145 1 1 0 1 0 -1.031-1.711 13.007 13.007 0 1 1 5.458-6.529 2.149 2.149 0 0 1 -4.158-.759v-10.856a1 1 0 0 0 -2 0v1.726a8 8 0 1 0 .2 10.325 4.135 4.135 0 0 0 7.83.274 15.2 15.2 0 0 0 .823-7.455zm-14.853 8.13a6 6 0 1 1 6-6 6.006 6.006 0 0 1 -6 6z"
                ></path>
            </svg>
            <input type="email" id="email" class="input" placeholder="E-posta Adresinizi Girin" required>
        </div>
        <div class="flex-column">
            <label>Şifre</label>
        </div>
        <div class="inputForm">
            <svg height="20" viewBox="-64 0 512 512" width="20" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="m336 512h-288c-26.453125 0-48-21.523438-48-48v-224c0-26.476562 21.546875-48 48-48h288c26.453125 0 48 21.523438 48 48v224c0 26.476562-21.546875 48-48 48zm-288-288c-8.8125 0-16 7.167969-16 16v224c0 8.832031 7.1875 16 16 16h288c8.8125 0 16-7.167969 16-16v-224c0-8.832031-7.1875-16-16-16zm0 0"
                ></path>
                <path
                    d="m304 224c-8.832031 0-16-7.167969-16-16v-80c0-52.929688-43.070312-96-96-96s-96 43.070312-96 96v80c0 8.832031-7.167969 16-16 16s-16-7.167969-16-16v-80c0-70.59375 57.40625-128 128-128s128 57.40625 128 128v80c0 8.832031-7.167969 16-16 16zm0 0"
                ></path>
            </svg>
            <input type="password" id="password" class="input" placeholder="Şifrenizi Girin" required>
        </div>
        <button type="button" class="button-submit" onclick="signUp()">Hesap Oluştur</button>
        <p class="p">Zaten bir hesabınız var mı? <span class="span" onclick="window.location.href='login.html'">Giriş Yap</span></p>
    </form>

    <!-- Pop-up Penceresi -->
    <div class="popup" id="popup">
        <div class="popup-content">
            <span class="close-btn" onclick="closePopup()">×</span>
            <p id="popup-message">Pop-up Mesajı</p>
            <button onclick="closePopup()">Kapat</button>
        </div>
    </div>

    <script>
  // Firebase ayarları
  const firebaseConfig = {
    apiKey: "AIzaSyC4aW-Mr469PsIYT8n3jL--GbtRU5OTWdo",
    authDomain: "smart-pay-6a9b8.firebaseapp.com",
    databaseURL: "https://smart-pay-6a9b8-default-rtdb.firebaseio.com",
    projectId: "smart-pay-6a9b8",
    storageBucket: "smart-pay-6a9b8.appspot.com",
    messagingSenderId: "9418007073",
    appId: "1:9418007073:web:72e0144eb56524fc263960"
  };
  
  // Firebase başlatma
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  
  // Pop-up açma fonksiyonu
  function openPopup(message) {
    document.getElementById('popup-message').innerText = message;
    document.getElementById('popup').style.display = 'flex';
  }
  
  // Pop-up kapama fonksiyonu
  function closePopup() {
    document.getElementById('popup').style.display = 'none';
  }
  
  // Hesap oluşturma fonksiyonu
  function signUp() {
    const name = document.getElementById("name").value;
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    const phone = document.getElementById("phone").value;
    const submitButton = document.querySelector(".button-submit");
    
    // تعطيل الزر أثناء إنشاء الحساب
    submitButton.disabled = true;
    
    if (!name || !email || !password || !phone) {
      openPopup("Lütfen tüm alanları doldurun.");
      submitButton.disabled = false; // إعادة تمكين الزر
      return;
    }
    
    const passwordRegex = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/;
    if (!passwordRegex.test(password)) {
      openPopup("Şifre en az 6 karakter olmalı, harf ve rakam içermelidir.");
      submitButton.disabled = false; // إعادة تمكين الزر
      return;
    }
    
    firebase.auth().fetchSignInMethodsForEmail(email)
      .then((methods) => {
        if (methods.length > 0) {
          openPopup("Bu e-posta adresi zaten kullanılıyor.");
          submitButton.disabled = false; // إعادة تمكين الزر
        } else {
          firebase.auth().createUserWithEmailAndPassword(email, password)
            .then((userCredential) => {
              const user = userCredential.user;
              db.collection("users").doc(user.uid).set({
                name: name,
                email: email,
                phone: phone, // Telefon numarasını kaydet
                uniqueId: generateUniqueId(),
                referralCode: generateReferralCode(),
                balance: 0,
                verified: false
              }).then(() => {
                openPopup("Hesap başarıyla oluşturuldu!");
                setTimeout(() => {
                  window.location.href = "index.html";
                }, 2000);
              }).catch((error) => {
                openPopup("Bilgiler kaydedilirken bir hata oluştu: " + error.message);
                submitButton.disabled = false; // إعادة تمكين الزر
              });
            }).catch((error) => {
              openPopup("Hata: " + error.message);
              submitButton.disabled = false; // إعادة تمكين الزر
            });
        }
      }).catch((error) => {
        openPopup("Hata: " + error.message);
        submitButton.disabled = false; // إعادة تمكين الزر
      });
  }
  
  // Benzersiz ID oluşturma fonksiyonu
  function generateUniqueId() {
    let uniqueId = '101';
    for (let i = 0; i < 10; i++) {
      uniqueId += Math.floor(Math.random() * 10);
    }
    return uniqueId;
  }
  
  // Yönlendirme kodu oluşturma fonksiyonu
  function generateReferralCode() {
    let code = '';
    const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    for (let i = 0; i < 7; i++) {
      code += characters.charAt(Math.floor(Math.random() * characters.length));
    }
    return code;
  }
</script>
</body>
</html>
